<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Negascout
  
    &mdash; Documentation by YARD 0.9.9
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Negascout";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (N)</a> &raquo;
    
    
    <span class="title">Negascout</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Negascout
  
  
  
</h1>
<div class="box_info">
  

  
  
  <dl>
      <dt>Extended by:</dt>
      <dd><span class='object_link'><a href="" title="Negascout (module)">Negascout</a></span></dd>
  </dl>
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="" title="Negascout (module)">Negascout</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/negascout.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The following example shows how to use negascout search on a custom Node
type. In order to the <span class='object_link'><a href="#negascout-instance_method" title="Negascout#negascout (method)">#negascout</a></span> to work the node type has to respond to
at least <code>:evaluate</code>, <code>:moves</code>, <code>:move!</code>,
<code>:unmove!</code> and <code>:terminal?</code> as shown in the following
example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Node</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='ivar'>@number</span> <span class='op'>=</span> <span class='id identifier rubyid_n'>n</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_evaluate'>evaluate</span>
    <span class='ivar'>@number</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_moves'>moves</span>
    <span class='lparen'>(</span><span class='int'>1</span><span class='op'>..</span><span class='int'>3</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_shuffle!'>shuffle!</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_move'>move</span><span class='lparen'>(</span><span class='id identifier rubyid_move'>move</span><span class='rparen'>)</span>
    <span class='ivar'>@number</span> <span class='op'>+=</span> <span class='id identifier rubyid_move'>move</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_unmove'>unmove</span><span class='lparen'>(</span><span class='id identifier rubyid_move'>move</span><span class='rparen'>)</span>
    <span class='ivar'>@number</span> <span class='op'>-=</span> <span class='id identifier rubyid_move'>move</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_terminal?'>terminal?</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='const'>Negascout</span><span class='period'>.</span><span class='id identifier rubyid_negascout'><span class='object_link'><a href="#negascout-instance_method" title="Negascout#negascout (method)">negascout</a></span></span><span class='lparen'>(</span><span class='const'>Node</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='comma'>,</span> <span class='int'>10</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>100</span><span class='comma'>,</span> <span class='int'>100</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='comment'># =&gt;
</span>  <span class='comment'>#&lt;Negascout::SearchResult:0x0000556b15b67530 @score=20, @best_line=[3, 1, 3]&gt;
</span></code></pre>

<p>We can extend the search with a transposition cache. One can also include
the <code>depth</code> at which the node is inserted in the cache and
return only if the cached value is “deep enough” or update the cache only
if the cached value is “shallower” than the current evaluation.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>MySearch</span>
  <span class='id identifier rubyid_include'>include</span> <span class='const'>Negascout</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
    <span class='ivar'>@cache</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_cache_insert'>cache_insert</span><span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='comma'>,</span> <span class='id identifier rubyid_depth'>depth</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_hash'>hash</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_cache_lookup'>cache_lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='comma'>,</span> <span class='id identifier rubyid_depth'>depth</span><span class='rparen'>)</span>
    <span class='ivar'>@cache</span><span class='lbracket'>[</span><span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_hash'>hash</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Negascout/SearchResult.html" title="Negascout::SearchResult (class)">SearchResult</a></span>
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cache_lookup-instance_method" title="#cache_lookup (instance method)">#<strong>cache_lookup</strong>(_node, _depth)  &#x21d2; Numeric<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Callback for shortcutting the search and do a cache lookup instead.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cache_update-instance_method" title="#cache_update (instance method)">#<strong>cache_update</strong>(_node, _depth, _deep_eval)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Callback for inserting a node into the cache.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#negascout-instance_method" title="#negascout (instance method)">#<strong>negascout</strong>(node, depth = 10, alpha = (-Float::Infinity), beta = Float::Infinity, colour = 1)  &#x21d2; SearchResult </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Negascout search function.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cache_lookup-instance_method">
  
    #<strong>cache_lookup</strong>(_node, _depth)  &#x21d2; <tt>Numeric</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>The default implementation just returns <code>nil</code>.</p>
</div>
  </div>


<p>Callback for shortcutting the search and do a cache lookup instead.</p>

<p>The cache should respond with <code>nil</code> if not found. The depth can
also be used as a measure of information reliability.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>_node</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the node to look up</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>_depth</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the current depth of the search</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numeric</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the evaluation on hit</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/negascout.rb', line 129</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cache_lookup'>cache_lookup</span><span class='lparen'>(</span><span class='id identifier rubyid__node'>_node</span><span class='comma'>,</span> <span class='id identifier rubyid__depth'>_depth</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cache_update-instance_method">
  
    #<strong>cache_update</strong>(_node, _depth, _deep_eval)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>The default implementation does nothing.</p>
</div>
  </div>


<p>Callback for inserting a node into the cache.</p>

<p>The current depth is also supplied together with the evaluation from the
search.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>_node</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the node to insert</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>_depth</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the current depth of the search</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>_deep_eval</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the evaluation returned from the search for the <code>node</code></p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/negascout.rb', line 146</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cache_update'>cache_update</span><span class='lparen'>(</span><span class='id identifier rubyid__node'>_node</span><span class='comma'>,</span> <span class='id identifier rubyid__depth'>_depth</span><span class='comma'>,</span> <span class='id identifier rubyid__deep_eval'>_deep_eval</span><span class='rparen'>)</span><span class='semicolon'>;</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="negascout-instance_method">
  
    #<strong>negascout</strong>(node, depth = 10, alpha = (-Float::Infinity), beta = Float::Infinity, colour = 1)  &#x21d2; <tt><span class='object_link'><a href="Negascout/SearchResult.html" title="Negascout::SearchResult (class)">SearchResult</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Negascout search function</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>node</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>current state of the game</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>depth</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>10</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the depth of the search</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>alpha</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>(-Float::Infinity)</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the initial alpha value</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>beta</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>Float::Infinity</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the initial beta value</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>colour</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>1</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the +1 if the next player to move tries to maximize the evaluation, -1 if
minimize</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Negascout/SearchResult.html" title="Negascout::SearchResult (class)">SearchResult</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the best line and the evaluation</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105
106
107
108
109
110
111
112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/negascout.rb', line 103</span>

<span class='kw'>def</span> <span class='id identifier rubyid_negascout'>negascout</span><span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='comma'>,</span>
              <span class='id identifier rubyid_depth'>depth</span> <span class='op'>=</span> <span class='int'>10</span><span class='comma'>,</span>
              <span class='id identifier rubyid_alpha'>alpha</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='op'>-</span><span class='const'>Float</span><span class='op'>::</span><span class='const'>Infinity</span><span class='rparen'>)</span><span class='comma'>,</span>
              <span class='id identifier rubyid_beta'>beta</span> <span class='op'>=</span> <span class='const'>Float</span><span class='op'>::</span><span class='const'>Infinity</span><span class='comma'>,</span>
              <span class='id identifier rubyid_colour'>colour</span> <span class='op'>=</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_with_cache'>with_cache</span><span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='comma'>,</span> <span class='id identifier rubyid_depth'>depth</span><span class='comma'>,</span> <span class='id identifier rubyid_colour'>colour</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='comment'># terminal node
</span>    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="Negascout/SearchResult.html" title="Negascout::SearchResult (class)">SearchResult</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_colour'>colour</span> <span class='op'>*</span> <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_evaluate'>evaluate</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_depth'>depth</span><span class='period'>.</span><span class='id identifier rubyid_zero?'>zero?</span> <span class='op'>||</span>
                                                       <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_terminal?'>terminal?</span>
    <span class='id identifier rubyid_maximize_alpha'>maximize_alpha</span><span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='comma'>,</span> <span class='id identifier rubyid_depth'>depth</span><span class='comma'>,</span> <span class='id identifier rubyid_alpha'>alpha</span><span class='comma'>,</span> <span class='id identifier rubyid_beta'>beta</span><span class='comma'>,</span> <span class='id identifier rubyid_colour'>colour</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Sep 25 19:39:16 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.9 (ruby-2.4.2).
</div>

    </div>
  </body>
</html>